var thegrid=function(t){var i,e,o,n,s,r,l=this,a={grid:$(".thegrid"),cells:$(".cell"),cellsPerRow:7,cellHeight:100,animationPlatform:"css",animationEasing:"swing",animationSpeed:500,animationDelay:0,updateGridHeight:!0,throttling:!1,throttlingDelay:300,breakpoints:{}},h={matrix:[],cols:0,rows:0,emptyCells:[],init:function(){this.emptyCells=[],this.cols=l.options.cellsPerRow,this.rows=Math.ceil(o/this.cols),this.matrix=matrix(this.cols,this.rows,null);for(var t=0;t<this.rows;t++)for(var i=0;i<l.options.cellsPerRow;i++)this.emptyCells.push(t+"."+i);return this},addEmptyCell:function(t){this.emptyCells.push(t[1]+"."+t[0]),this.emptyCells.sort(function(t,i){return t-i})},removeEmptyCell:function(t){var i=this.emptyCells.indexOf(t[1]+"."+t[0]);i>-1&&this.emptyCells.splice(i,1),this.emptyCells.sort(function(t,i){return t-i})},inject:function(t,i,e){var o={w:i[0],h:i[1]},n=o.w,s=o.h;for(void 0===e&&(e=this.getNextEmptyCell());!this.canFit(i,e);)e=this.getNextCell(e);for(var r=e[0],l=e[1];n>0;){for(this.matrix[l][r]=t,this.removeEmptyCell([r,l]),s=o.h-1;s>0;)l++,this.matrix[l][r]=t,this.removeEmptyCell([r,l]),s--;n--,r++}return e},getNextEmptyCell:function(){if(!this.emptyCells.length)return this.addNewRow();var t=this.emptyCells[0].split(".");return[parseInt(t[1]),parseInt(t[0])]},getNextCell:function(t){return void 0===t&&(t=[0,0]),void 0!==this.matrix[t[1]][t[0]+1]?[t[0]+1,t[1]]:[0,t[1]+1]},addNewRow:function(){this.matrix.push(matrix(this.cols,1,null)[0]),this.rows++;for(var t=0;t<this.cols;t++)this.addEmptyCell([t,this.rows-1]);return[0,this.rows-1]},isCellEmpty:function(t){return void 0===this.matrix[t[1]]?(this.addNewRow(),!0):null===this.matrix[t[1]][t[0]]},canFit:function(t,i){for(var e=t[0],o=t[1],n=i[0],s=i[1],r=0,l=0,a=n;n+e>a;a++)this.isCellEmpty([a,s])===!0&&r++;for(var h=s;s+o>h;h++)this.isCellEmpty([n,h])===!0&&l++;return r>=e&&l>=o}};l.throttleTimer=null;var p=function(){h.init(l.options.cellsPerRow,Math.ceil(o/l.options.cellsPerRow),null),e.each(function(t,i){i=$(i);var e=Math.min(i.data("width"),l.options.cellsPerRow)||1,o=i.data("height")||1,n=h.inject(t,[Math.min(e,l.options.cellsPerRow),o]);i[0].matrixPosition={x:n[0],y:n[1]}})},c=function(){e.each(function(t,i){i=$(i);var e=Math.min(i.data("width"),l.options.cellsPerRow)||1,o=i.data("height")||1,r={width:n*e+"%",height:s*o,top:i[0].matrixPosition.y*s,left:100*i[0].matrixPosition.x/l.options.cellsPerRow+"%"};setTimeout(function(){"js"===l.options.animationPlatform?i.stop(!0,!0).animate(r,l.options.animationSpeed,l.options.animationEasing):i.css(r)},l.options.animationDelay)}),l.options.updateGridHeight&&i.height(h.rows*l.options.cellHeight)};l.updateParams=function(i){return l.options=$.extend(t,i),n=100/l.options.cellsPerRow,s=l.options.cellHeight,this},l.filter=function(t,i,n){return i=void 0!==i?i:!1,n=void 0!==n?n:!1,t=t instanceof jQuery?t:$(t),cellsToShow=i?n?$(l.options.cells).not(t):null:t,cellsToHide=i?t:n?$(l.options.cells).not(t):null,cellsToShow&&cellsToShow.css({top:0,left:0}).removeClass("hidden"),cellsToHide&&(cellsToHide.addClass("hidden"),setTimeout(function(){cellsToHide.css({top:0,left:0})},l.options.animationSpeed)),e=cellsToShow,o=e.length,r&&l.sort(),this},l.sort=function(){if(r){var t=null;for(var i in r)r[i].active&&(t=e.slice(0).sort(function(t,e){var o,n="asc"===r[i].order?1:-1;switch(t=t.attributes["data-"+i].value||"",e=e.attributes["data-"+i].value||"",r[i].type){case"int":case"float":t=parseFloat(t),e=parseFloat(e),o=t-e;break;default:o=e>t?-1:t>e?1:0}return o*n}),e=t||r["default"]);return this}};var d=function(){r={};for(var t in l.options.sortingCriteria)r[t]=l.options.sortingCriteria[t],r[t].sorted=e;return r["default"]=e.slice(0),$("[data-sort]").on("change",function(){this.pos=((this.pos||0)+1)%3;var i=["","asc","desc"][this.pos];t=$(this).data("sort"),$(this).attr("data-order",i),r[t].order=i,r[t].active=this.pos,l.sort().redraw()}),this};l.resetFilters=function(){return e=$(l.options.cells).removeClass("hidden"),o=e.length,r&&l.sort(),this},l.redraw=function(){return p(),c(),i.trigger("redraw"),this};var u=function(){if(!$.isEmptyObject(l.options.breakpoints)){var t,e,o=[],n=0;for(var s in l.options.breakpoints)o.push(1*s);e=o.length,o.sort(function(t,i){return 1*t-1*i}),n=o[e-1]+"++",l.options.breakpoints[n]=JSON.parse(JSON.stringify(l.options)),delete l.options.breakpoints[n].breakpoints,o.push(n),e++,$(window).on("resize gridInit afterResize",function(e){if(l.options.throttling&&"resize"===e.type)return l.throttleTimer=setTimeout(function(){clearTimeout(l.throttleTimer),l.throttleTimer=null,$(window).trigger("afterResize")},l.options.throttlingDelay),!0;var n,s={},r=this.innerWidth,a=[],h=!1;a=o.slice(0),a.push(r),a.sort(function(t,i){return"string"==typeof t&&t.indexOf("++")>-1||parseInt(t)-parseInt(i)});var p=a.indexOf(r);n=o[p],h=n!==t,(h||"function"==typeof l.options.cellHeight)&&(t=n,"gridInit"!==e.type&&h&&i.trigger("breakpointChange",[t]),s=l.options.breakpoints[t],l.updateParams(s).redraw())})}};(function(){l.options=$.extend(a,t),i=$(l.options.grid),delete l.options.grid,e=$(l.options.cells).not(".hidden"),o=e.length,n=100/l.options.cellsPerRow,s=l.options.cellHeight,i.css("height",Math.ceil(o/l.options.cellsPerRow)*l.options.cellHeight),l.options.sortingCriteria&&d(),u(),p(),c(),$.isEmptyObject(l.options.breakpoints)||$(window).trigger("gridInit"),i.trigger("ready").addClass("ready"+("js"===l.options.animationPlatform?"":" transitions"))})()},matrix=function(t,i,e){for(var o=0,n=[];i>o;o++){n.push([]),n[o].push(new Array(t));for(var s=0;t>s;s++)n[o][s]=e}return n};$.fn.grid=function(t){var i,e,o=this[0];switch(!0){case!o||void 0===o:e="Can't instantiate The Grid on an empty jQuery collection.";break;case-1===["object","undefined","string"].indexOf(typeof t):i="Ignoring grid call with wrong params.";break;case"string"==typeof t&&"function"!=typeof o.grid[t]:i='Ignoring unknown Grid method call "'+t+'".'}if(i||e)console[e?"error":"warn"](i||e);else if("object"==typeof t||void 0===t)(t||{grid:null}).grid=o,o.grid=new thegrid(t);else if("string"==typeof t&&void 0!==o&&"function"==typeof o.grid[t]){var n=[].slice.call(arguments,1);o.grid[t].apply(this,n)}return this};